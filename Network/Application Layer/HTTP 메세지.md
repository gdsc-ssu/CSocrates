
HTTP 프로그램은 일을 처리하기 위해 메세지를 주고 받는다.
이제 어떻게 메세지를 만들고 이해하는지 알아보자.


# 메세지의 흐름

인바운드 : 메세지가 서버로 향하는 것
아웃바운드 : 모든 처리가 끝나고 다시 클라이언트로 돌아오는 것

다운 스트림 : 메세지의 흐름. 항상 발송 측 -> 수신 측으로 메세지가 흐른다. 당연한 말.

# 메세지의 각 부분

시작 줄과 헤더 끝에는 CRLF 라는 줄바꿈 문자열로 나눈다.

### 시작 줄
```
HTTP/1.0 200 OK
```

### 헤더
```
Content-type: text/plain
Content-length: 19
```

Content-type은 본문이 무엇인지, Content-length는 본문의 길이를 의미함.

### 개체 본문
```
Hi! I'm a message
```
본문은 없을 수도 있음. 이진 데이터일 수도 있고, 그냥 plain text일 수도 있음. 이는 헤더에서 결정함.


# 메세지 문법
요청 메세지와 응답 메세지는 시작 줄 부분만 다르고, 나머지는 동일하다.
- 요청 메세지 :` <메소드> <요청 URL> <버전> <CRLF> <헤더> <CRLF> <본문>`
- 응답 메세지 :  `<버전> <상태 코드> <사유 구절> <CRLF> <헤더> <CRLF> <본문>`

- 메소드 : GET, HEAD, POST 등과 같이 한 단어로 되어있는, 클라이언트 측에서 서버가 리소스에 대해 수행해주길 바라는 동작.
- 요청 URL : 요청 대상이 되는 리소스를 지칭하는 URL 또는 경로 구성 요소.
- 버전 : `HTTP/<메이저>.<마이너>` 형식.
- 상태 코드 : 요청 중에 무엇이 일어났는지 설명하는 3자리 숫자. 
- 사유 구절 (reason-phrase) : 상태 코드의 의미를 사람이 이해할 수 있도록 설명해주는 짧은 문구.
- 헤더 : 이름, 콜론, 공백, 값, CRLF가 순서대로 나타나는 0개 이상의 헤더들.
- 엔티티 본문 : 비어 있을 수도 있는, 데이터 덩어리.

### 시작 줄
요청 메세지의 시작 줄은 무엇을 해야 하는지 말해준다.
응답 메세지의 시작 줄은 무슨 일이 일어났는지 말해준다.

### 헤더
애플리케이션은 자유롭게 자신만의 헤더를 만들어낼 수 있다.
- 일반 헤더 : 요청과 응답 양쪽 모두에 나타날 수 있는 일반적인 헤더
- 요청 헤더 : 요청에 대한 부가 정보
- 응답 헤더 : 응답에 대한 부가 정보
- Entity 헤더 : 본문 크기와 콘텐츠, 혹은 리소스 그 자체를 서술
- 확장 헤더 : 명세에 정의되지 않은 새로운 헤더
각 헤더는 공백 또는 개행으로 구분해주면 된다.

### 본문
이미지, 비디오, HTML 문서, 소프트웨어 애플리케이션, 신용카드 트랜잭션, 전자우편 등 다양한 종류의 데이터를 포함할 수 있음.

# 메소드
### GET
서버에게 리소스를 달라고 요청하기 위해 쓰인다.

### HEAD
GET과 같지만 본문 전송 없이 헤더만 전송한다.
본문 없이 해당 타입, 존재 여부, 리소스 변경 여부 등을 확인할 수 있다.
GET과 HEAD의 헤더는 동일해야 한다.

### PUT
서버에 문서를 쓴다는 요청을 하기 위해 쓰인다.

### POST
서버에 입력 데이터를 전송하기 위해 쓰인다.
주로 폼 데이터를 서버로 전송할 때 이 메소드가 사용된다.

### TRACE
진단을 위해 사용된다. 목적지 서버에서 루프백 진단을 시작하면, 역으로 진행하며 자신이 받은 요청 메세지를 TRACE응답으로 돌려준다.
엔티티 본문을 포함할 수 없다.

### OPTIONS
특정 리소스에 대해 어떤 메서드가 지원되는지 물어볼 때 쓰인다.
ex) Allow: GET, POST, PUT, OPTIONS

### DELETE
지정한 리소스의 삭제를 요청할 때 사용한다.

### 확장
github api의 X-RateLimit-Limit 같은 헤더도 확장된 메소드 중 하나이다.
명세가 정의되어 있고, 이를 공개하면 확장을 만든 것이다!

# 상태 코드
### 100 ~ 199 : 정보성 상태 코드
비교적 새로 도입되었으며, 100번 continue가 잘 알려져 있다. 요청의 시작 부분 일부가 받아들여졌으며, 클라이언트는 나머지를 계속 보내야 한다는 뜻.
100 : Continue
101 : Switching Protocols
### 200 ~ 299 : 성공 상태 코드
200 : OK
201  : Created
202 : Accepted
등등..
### 300 ~ 399 : 리다이렉션 상태 코드
클라이언트가 관심있어하는 리소스에 대해 다른 위치를 사용하라고 말해주거나, 다른 대안 응답을 제공.
location을 제공하는 경우, 해당 페이지로 이동한다.
300 : Multiple Choices
301 : Moved Permanently
302: Found
304 : Not Modified
등등..
### 400 ~ 499 : 클라이언트 에러 상태 코드
서버가 다룰 수 없는 무엇인가를 보낼 때 이 코드를 마주하게 된다.
잘못 구성된 요청 메세지 등등..
400 : Bad Request
401 : Unathorized
403 : Forbidden
404 : Not Found
등등..
### 500 ~ 599 : 서버 에러 상태 코드
올바른 요청을 보냈음에도 서버 자체에서 에러가 발생하는 경우.
500 : Internal Server Error
501 : Not Implemented
502 : Bad Gateway
503 : Service Unavailable

# HTTP 헤더

- 일반 헤더, 일반 캐시 헤더
- 요청 헤더, Accept 관련 헤더, 조건부 요청 헤더, 요청 보안 헤더, proxy 요청 헤더
- 응답 헤더, 협상 헤더, 응답 보안 헤더
- 엔티티 헤더, 콘텐츠 헤더, 엔티티 캐싱 헤더

# Reference
HTTP 완벽 가이드 - 데이빗 고울리, 브라이언 토티, 마조리 세이어, 세일루 레디, 안슈 아가왈
https://www.w3.org/Protocols/rfc2616/rfc2616.txt
https://www.w3.org/Protocols/
